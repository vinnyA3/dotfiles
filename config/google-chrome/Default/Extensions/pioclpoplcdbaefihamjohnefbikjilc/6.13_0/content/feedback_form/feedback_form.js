/*! Copyright 2009-2017 Evernote Corporation. All rights reserved. */

function closeForm(){Browser.sendToExtension({name:"bounce",message:{name:"closeFeedbackForm"}})}function msgHandlerConfig(a,b,c){/china/i.test(a.bootstrapInfo.name)&&document.body.classList.add("china"),c&&"function"==typeof c&&c()}function submit(){var a=title.value.trim(),b=details.value.trim();""==a||""==b||rating.selectedIndex<0?Browser.sendToExtension({name:"showAlert",msg:Browser.i18n.getMessage("allFieldsRequired")}):(Browser.sendToExtension({name:"sendAppFeedback",title:a,details:b,os:sInfo.os,browser:sInfo.browser,rating:parseInt(rating.selectedOptions[0].value)}),Browser.sendToExtension({name:"trackEvent",category:"Ratings",action:"feedback_form",label:"submitted"}),closeForm())}var closeButton,systemInfo,title,details,rating,sInfo=GlobalUtils.generateSystemInfo();window.addEventListener("DOMContentLoaded",function(){closeButton=document.getElementById("close"),systemInfo=document.getElementById("systemInfo"),title=document.getElementById("title"),details=document.getElementById("details"),rating=document.getElementById("rating"),GlobalUtils.localize(document.body),systemInfo.innerText+=":\n"+sInfo.browser+"\n"+sInfo.os+"\n"+navigator.language,rating.selectedIndex=-1,closeButton.addEventListener("click",closeForm),closeButton.addEventListener("keypress",function(a){13==a.keyCode&&closeForm()}),document.getElementById("send").addEventListener("click",submit),title.addEventListener("keypress",function(a){13==a.keyCode&&submit()}),Browser.sendToExtension({name:"main_getConfig",bootstrapInfo:{name:null},returnName:"feedbackFormConfig"})}),Browser.addMessageHandlers({feedbackFormConfig:msgHandlerConfig});