/*! Copyright 2009-2017 Evernote Corporation. All rights reserved. */

function initClearlyComponent__reformat(a){if(!a)return!1;var b=a;switch(!0){case!b.settings:case!b.settings.path:case!b.window:case!b.window.document:case!b.window.document.body:case!b.jQuery:return b.debug&&(console.log(!b.settings),console.log(!b.settings.path),console.log(!b.window),console.log(!b.window.document),console.log(!b.window.document.body),console.log(!b.jQuery)),!1}b.document=b.window.document;var c=function(a,c){b.settings[a]||(b.settings[a]=c)};c("onCreateFrameUseThisId","clearly_frame"),c("onCreateFrameUseThisBaseTimer",50),c("onCreateFrameUseThisURLAsTheLocation",""),c("onCreateFrameDoNotInsertCSS",!1),c("onCreateFrameInjectThisHTMLAfter",""),c("onCreateFrameInjectThisHTMLBefore",""),c("onCreateFrameWaitForTheseWindowVars",[]),c("onGetCSSFromOptionsInjectThisCSSAfter",""),c("onAddPageAttachFootnotesToLinks",!1),c("createFrameInsideElementWithThisId",""),c("pageLabel",function(a){return a}),c("linksLabel",""),c("articleTitleMarker__end",'</h1><div id="articleHeader__separator"></div></div>'),c("articleTitleMarker__end__separator",'<div id="articleHeader__separator"></div>'),c("doDocumentWrite",function(a,b){a.open(),a.write(b),a.close()}),c("cssPath",b.settings.path+"css/"),c("https",/^https:/gi.test(b.window.location.href));var d=b.jQuery;if(b.$window=d(b.window),b.$document=d(b.document),b.pagesCount=0,b.footnotedLinksCount=0,b.debug=b.debug||!1,b.debugRemembered={},b.debugTimers=[],b.debug){switch(!0){case!(!b.window.console||!b.window.console.log):b.logOneLine=function(a){b.window.console.log(a)};break;case!(!b.window.opera||!b.window.opera.postError):b.logOneLine=function(a){b.window.opera.postError(a)};break;default:b.logOneLine=function(a){}}b.log=function(){if(b.debug){for(var a=0,c=arguments.length;a<c;a++)b.logOneLine(arguments[a]);b.logOneLine("-----------------------------------------")}},b.debugRemember=function(a,c){b.debugRemembered[a]=c}}else b.logOneLine=function(){return!1},b.log=function(){return!1},b.debugRemember=function(){return!1};return b.escape_html=function(a){var b={"&":"amp",'"':"quot","<":"lt",">":"gt"};return a&&a.replace?a.replace(/[&"<>]/g,function(a){return"&"+b[a]+";"}):""},b.encode=function(a){if(""==a)return"none";var b={"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A"};return a&&a.replace?a.replace(/[!'()*]/g,function(a){return b[a]}):""},b.decode=function(a){return"none"==a?"":a&&a.replace?decodeURIComponent(a):""},function(){!!b.defaultThemes||(b.defaultThemes={newsprint:{text_font:'"PT Serif"',text_font_header:'"PT Serif"',text_font_monospace:"Inconsolata",text_size:"16px",text_line_height:"1.5em",box_width:"36em",color_background:"#f3f2ee",color_text:"#1f0909",color_links:"#065588",text_align:"normal",base:"newsprint",footnote_links:"on_print",large_graphics:"do_nothing",custom_css:""},notable:{text_font:"Helvetica, Arial",text_font_header:"Helvetica, Arial",text_font_monospace:'"Droid Sans Mono"',text_size:"14px",text_line_height:"1.5em",box_width:"42em",color_background:"#fff",color_text:"#333",color_links:"#090",text_align:"normal",base:"notable",footnote_links:"on_print",large_graphics:"do_nothing",custom_css:""},night_owl:{text_font:'"PT Serif"',text_font_header:'"PT Serif"',text_font_monospace:"Inconsolata",text_size:"16px",text_line_height:"1.5em",box_width:"36em",color_background:"#2d2d2d",color_text:"#e3e3e3",color_links:"#e3e3e3",text_align:"normal",base:"night_owl",footnote_links:"on_print",large_graphics:"do_nothing",custom_css:""}})}(),function(){!!b.availableFontSizes||(b.availableFontSizes={small:{newsprint:"12px",notable:"12px",night_owl:"12px"},medium:{newsprint:"16px",notable:"16px",night_owl:"16px"},large:{newsprint:"20px",notable:"20px",night_owl:"20px"}})}(),function(){if(b.availableGoogleFonts)return!0;var a=["Arvo","Bentham","Cardo","Copse","Corben","Crimson Text","Droid Serif","Goudy Bookletter 1911","Gruppo","IM Fell","Josefin Slab","Kreon","Meddon","Merriweather","Neuton","OFL Sorts Mill Goudy TT","Old Standard TT","Philosopher","PT Serif","Radley","Tinos","Vollkorn","Allerta","Anton","Arimo","Bevan","Buda","Cabin","Cantarell","Coda","Cuprum","Droid Sans","Geo","Josefin Sans","Lato","Lekton","Molengo","Nobile","Orbitron","PT Sans","Puritan","Raleway","Syncopate","Ubuntu","Yanone Kaffeesatz","Anonymous Pro","Cousine","Droid Sans Mono","Inconsolata"];b.availableGoogleFonts={};for(var c=0,d=a.length;c<d;c++)b.availableGoogleFonts[a[c]]=1}(),function(){!!b.defaultOptions||(b.defaultOptions={text_font:b.encode('"PT Serif"'),text_font_header:b.encode('"PT Serif"'),text_font_monospace:b.encode("Inconsolata"),text_size:b.encode("16px"),text_line_height:b.encode("1.5em"),box_width:b.encode("36em"),color_background:b.encode("#f3f2ee"),color_text:b.encode("#1f0909"),color_links:b.encode("#065588"),text_align:b.encode("normal"),base:b.encode("newsprint"),footnote_links:b.encode("on_print"),large_graphics:b.encode("do_nothing"),custom_css:b.encode("")})}(),b.getCSSFromOptions=function(a){var c="4.5em",d="9em";switch(!0){case null!=a.text_line_height.match(/%/):case null!=a.text_line_height.match(/^([0-9.]+)$/):break;default:c=a.text_line_height.replace(/^([0-9.]+)/,function(a,b){return 3*(0+b)}),d=a.text_line_height.replace(/^([0-9.]+)/,function(a,b){return 6*(0+b)})}return("#body { font-family: [=text_font]; font-size: [=text_size]; line-height: [=text_line_height]; color: [=color_text]; text-align: "+("justified"==a.text_align?"justify":"left")+"; } #text { padding-top: "+c+";padding-bottom: "+d+";} #background { background-color: [=color_background]; } .setTextColorAsBackgroundColor { background-color: [=color_text]; } .setBackgroundColorAsTextColor { color: [=color_background]; } .setBackgroundColor { background-color: [=color_background]; } .setTextColor { color: [=color_text]; } #box, .setBoxWidth { width: [=box_width]; } a { color: [=color_links]; } a:visited { color: [=color_text]; } @media print { body.footnote_links__on_print a, body.footnote_links__on_print a:hover { color: [=color_text] !important; text-decoration: none !important; } } body.footnote_links__always a, body.footnote_links__always a:hover { color: [=color_text] !important; text-decoration: none !important; } img { border-color: [=color_text]; } a img { border-color: [=color_links]; } a:visited img { border-color: [=color_text]; } h1 a, h2 a, a h1, a h2 { color: [=color_text]; } h1, h2, h3, h4, h5, h6 { font-family: [=text_font_header]; } pre { background-color: [=color_background]; } pre, code { font-family: [=text_font_monospace]; } hr { border-color: [=color_text]; } html.rtl #body #text { text-align: "+("justified"==a.text_align?"justify":"right")+" !important; } h1, h2, h3, h4, h5, h6 { text-align: left; } html.rtl h1, html.rtl h2, html.rtl h3, html.rtl h4, html.rtl h5, html.rtl h6 { text-align: right !important; } #text div.separatorLine, #text section::before { background:      -o-linear-gradient(0, [=color_background] 1%, [=color_text] 50%, [=color_background] 99%); background:    -moz-linear-gradient(0, [=color_background] 1%, [=color_text] 50%, [=color_background] 99%); background: -webkit-linear-gradient(0, [=color_background] 1%, [=color_text] 50%, [=color_background] 99%); }[=custom_css] "+b.settings.onGetCSSFromOptionsInjectThisCSSAfter).replace(/\[=([a-z_]+?)\]/gi,function(b,c){return a[c]})},b.appliedOptions={},b.loadedGoogleFonts={},b.applyUnencodedOptions=function(a){var c={};for(var d in a)c[d]=b.encode(a[d]);b.applyEncodedOptions(c)},b.applyEncodedOptions=function(a){var c=b.defaultOptions;a||(a={});for(var d in c)switch(!0){case!(d in a):case!(a[d]>""):a[d]=b.appliedOptions[d]?b.appliedOptions[d]:c[d]}var e=!1,f=!1,g={};switch(!0){case!("base"in b.appliedOptions):case!(a.base==b.appliedOptions.base):e=!0}for(var d in c){switch(!0){case!(d in b.appliedOptions):case!(a[d]==b.appliedOptions[d]):f=!0}if(f)break}for(var d in c)b.appliedOptions[d]=a[d],g[d]=b.decode(a[d]);if(e&&(b.$iframeDocument.find("#baseCSS").remove(),g.base>"")){var h=g.base;switch(h){case"theme-1":h="newsprint";break;case"theme-2":h="notable";break;case"theme-3":h="night_owl"}b.$iframeDocument.find("head").append('<link id="baseCSS" href="'+b.escape_html(b.settings.cssPath)+"base__"+b.escape_html(h)+'.css" rel="stylesheet" class="'+b.escape_html(h)+'" type="text/css" />')}if(f){var i=b.getCSSFromOptions(g);b.$iframeDocument.find("#optionsCSS").remove();var j=b.iframeDocument.createElement("style");j.setAttribute("type","text/css"),j.setAttribute("id","optionsCSS"),j.styleSheet?j.styleSheet.cssText=i:j.appendChild(b.iframeDocument.createTextNode(i)),b.$iframeDocument.find("head").append(j),b.$iframeDocument.find("body").removeClass("footnote_links__on_print footnote_links__always footnote_links__never").removeClass("large_graphics__do_nothing large_graphics__hide_on_print large_graphics__hide_always").addClass("footnote_links__"+g.footnote_links).addClass("large_graphics__"+g.large_graphics)}},b.applyCustomCSSFile=function(a){var c=a;switch(c){case"theme-1":c="newsprint";break;case"theme-2":c="notable";break;case"theme-3":c="night_owl"}var d=b.settings.cssPath+"custom__"+c+".css";d!=b.$iframeDocument.find("#customFileCSS").attr("href")&&(b.$iframeDocument.find("#customFileCSS").remove(),b.$iframeDocument.find("head").append('<link id="customFileCSS" href="'+b.escape_html(d)+'" rel="stylesheet" type="text/css" />'))},b.getGoogleFontsFromOptions=function(a){var c={},d=[],e=function(a,d){d in b.availableGoogleFonts&&(c[d]=1)};a.text_font.replace(/"([^",]+)"/gi,e),a.text_font.replace(/([^",\s]+)/gi,e),a.text_font_header.replace(/"([^",]+)"/gi,e),a.text_font_header.replace(/([^",\s]+)/gi,e),a.text_font_monospace.replace(/"([^",]+)"/gi,e),a.text_font_monospace.replace(/([^",\s]+)/gi,e),a.custom_css.replace(/font-family: "([^",]+)"/gi,e),a.custom_css.replace(/font-family: ([^",\s]+)/gi,e);for(var f in c)d.push("http"+(b.settings.https?"s":"")+"://fonts.googleapis.com/css?family="+f.replace(/\s+/g,"+")+":regular,bold,italic");return d},b.loadGoogleFontsRequiredByAppliedOptions=function(){var a={};for(var c in b.appliedOptions)a[c]=b.decode(b.appliedOptions[c]);for(var d=b.getGoogleFontsFromOptions(a),e=0,f=d.length;e<f;e++)b.loadedGoogleFonts[d[e]]||(b.$iframeDocument.find("head").append('<link href="'+b.escape_html(d[e])+'" rel="stylesheet" type="text/css" />'),b.loadedGoogleFonts[d[e]]=1)},b.createFrame=function(){var a=b.settings.onCreateFrameUseThisId,c=b.document.createElement("iframe"),e=b.settings.onCreateFrameInjectThisHTMLBefore+'<div id="bodyContent"><div id="box"><div id="box_inner"><div id="text"><div id="pages"></div><div id="footnotedLinks" class="separateSection"><div id="footnotedLinks__separator" class="separator"><div class="separatorLine setTextColorAsBackgroundColor"></div>'+(b.settings.linksLabel>""?'<div class="separatorLabel setBackgroundColor">'+b.escape_html(b.settings.linksLabel)+"</div>":"")+'</div><ol id="footnotedLinks__list"></ol></div><div id="measure__lineHeight">Measure</div><div id="measure__fontSize">Measure</div></div></div></div><div id="background"></div></div><link rel="stylesheet" href="'+b.settings.cssPath+'style.css" type="text/css" />'+b.settings.onCreateFrameInjectThisHTMLAfter,f='<!DOCTYPE html><html id="html"><body id="body">'+e+"</body></html>";if(c.setAttribute("id",a),c.setAttribute("frameBorder","0"),c.setAttribute("allowTransparency","true"),c.setAttribute("scrolling","auto"),b.settings.onCreateFrameUseThisURLAsTheLocation>""&&c.setAttribute("src",b.settings.onCreateFrameUseThisURLAsTheLocation),b.settings.onCreateFrameDoNotInsertCSS);else{var g=b.document.createElement("style"),h="#"+a+" { margin: 0; padding: 0; border: none; position: absolute; width: 10px; height: 10px; top: -100px; left: -100px; } ";g.setAttribute("id",a+"__css"),g.setAttribute("type","text/css"),g.styleSheet?g.styleSheet.cssText=h:g.appendChild(b.document.createTextNode(h))}var i=b.settings.createFrameInsideElementWithThisId>""&&b.document.getElementById(b.settings.createFrameInsideElementWithThisId),j=i||b.document.body;g&&j.appendChild(g),j.appendChild(c);var k=!1,l=function(){var c=b.document.getElementById(a);if(c){var d=c.contentDocument||c.contentWindow.document;if(d){if(b.settings.onCreateFrameUseThisURLAsTheLocation>""){var g=d.getElementById("body")||d.body;if(!g)return;g.innerHTML=e}else b.settings.doDocumentWrite(d,f);b.window.clearInterval(k)}}};k=b.window.setInterval(l,b.settings.onCreateFrameUseThisBaseTimer);var m=!1,n=function(){var c=b.document.getElementById(a);if(c){var e=c.contentDocument||c.contentWindow.document;if(e){if(e.getElementById("bodyContent")){for(var f="",g=0,h=b.settings.onCreateFrameWaitForTheseWindowVars.length;g<h;g++)if(f=b.settings.onCreateFrameWaitForTheseWindowVars[g],!1===f.indexOf(".")){if(!(f in c.contentWindow))return}else for(var i=f.split("."),j=c.contentWindow,k=0,l=i.length;k<l;k++){if(!(i[k]in j))return;j=j[i[k]]}b.window.clearInterval(m),b.iframe=c,b.$iframe=d(b.iframe),b.iframeDocument=e,b.$iframeDocument=d(b.iframeDocument),b.iframeWindow=c.contentWindow,b.$iframeWindow=d(b.iframeWindow),b.$iframeBox=b.$iframeDocument.find("#box"),b.$iframePages=b.$iframeDocument.find("#pages"),b.$iframeBackground=b.$iframeDocument.find("#background"),b.$iframeFootnotedLinksList=b.$iframeDocument.find("#footnotedLinks__list"),b.callbacks&&b.callbacks.frameCreated&&b.callbacks.frameCreated()}}}};m=b.window.setInterval(n,b.settings.onCreateFrameUseThisBaseTimer)},b.addNewPage=function(a,c){var e=b.pagesCount+1;if(b.pagesCount++,e>1&&b.$iframePages.append('<div class="separator"><div class="separatorLine setTextColorAsBackgroundColor"></div><div class="separatorLabel setBackgroundColor"><em>'+b.escape_html(b.settings.pageLabel(b.escape_html(""+e)))+"</em></div></div>"),1==e&&b.settings.articleTitleMarker__end>""){var f=b.settings.articleTitleMarker__end.replace(b.settings.articleTitleMarker__end__separator,'<div id="articleHeader__separator" class="separator"><div class="separatorLine setTextColorAsBackgroundColor"></div></div>');a=a.replace(b.settings.articleTitleMarker__end,f)}b.$iframePages.append('<div class="page" id="page'+b.escape_html(""+e)+'"><div class="page_content">'+a+"</div></div>");var g=b.$iframeDocument.find("#page"+e);b.settings.onAddPageAttachFootnotesToLinks&&g.find("a").each(function(a,c){var e=c.href;if(e>""&&e.indexOf&&!(e.indexOf("#")>-1)){b.footnotedLinksCount++;var f=b.footnotedLinksCount;d(c).append('<sup class="readableLinkFootnote">['+b.escape_html(""+f)+"]</sup>"),b.$iframeFootnotedLinksList.append('<li><a href="'+b.escape_html(e)+'">'+b.escape_html(e)+"</a></li>")}})},b.clearAllPages=function(){b.pagesCount=0;for(var a=b.$iframePages.get(0);a.firstChild;)a.removeChild(a.firstChild);b.footnotedLinksCount=0;for(var c=b.$iframeFootnotedLinksList.get(0);c.firstChild;)c.removeChild(c.firstChild)},b}